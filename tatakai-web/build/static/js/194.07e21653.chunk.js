"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[194],{6194:(e,a,s)=>{s.r(a),s.d(a,{default:()=>p});var t=s(5043),i=s(6058),n=s(7304),r=s(697),o=s(2524),l=s(8109),c=s(6446),d=s(3204),h=s(6801),m=s(579);n.t1.register(n.PP,n.kc,n.FN,n.No,n.hE,n.m_,n.s$,n.dN);const p=()=>{const{token:e}=(0,t.useContext)(r.c),{workouts:a}=(0,t.useContext)(o.Z),{templates:s,refreshTemplates:n}=(0,t.useContext)(l.m),[p,g]=(0,t.useState)(null),[u,v]=(0,t.useState)([]),[x,f]=(0,t.useState)("month");(0,t.useEffect)(()=>{0===s.length&&e&&n()},[s.length,e,n]),(0,t.useEffect)(()=>{(async()=>{if(e)try{const a=await fetch("/api/metrics",{headers:{"x-auth-token":e}});a.ok&&v(await a.json())}catch(a){console.error("Failed to fetch metrics:",a)}})()},[e]);const b=(0,t.useMemo)(()=>{if(!p||0===a.length)return[];const e=new Date,s=new Date;return"week"===x&&s.setDate(e.getDate()-7),"month"===x&&s.setMonth(e.getMonth()-1),"year"===x&&s.setFullYear(e.getFullYear()-1),"all"===x&&s.setFullYear(1900),a.filter(e=>{const a=new Date(e.date),t=e.exercises.some(e=>p.exercises.some(a=>a.name.toLowerCase()===e.name.toLowerCase()));return a>=s&&t}).sort((e,a)=>new Date(e.date)-new Date(a.date))},[a,p,x]),j=(0,t.useMemo)(()=>p&&0!==b.length?p.exercises.map(e=>{const a=e.name.toLowerCase(),s=[];if(b.forEach(e=>{const t=e.exercises.find(e=>e.name.toLowerCase()===a);t&&s.push({date:e.date,weight:Number(t.weight)||0,sets:Number(t.sets)||0,reps:Number(t.reps)||0,volume:Number(t.sets)*Number(t.reps)*Number(t.weight)||0})}),0===s.length)return null;const t=s[s.length-1],i=s.length>1?s[s.length-2]:null,n=i?{weightDiff:t.weight-i.weight,setsDiff:t.sets-i.sets,repsDiff:t.reps-i.reps,volumeDiff:t.volume-i.volume,volumeChange:i.volume?((t.volume-i.volume)/i.volume*100).toFixed(1):0}:null,r={labels:s.map(e=>new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Weight",data:s.map(e=>e.weight),borderColor:"#8b5cf6",backgroundColor:"rgba(139, 92, 246, 0.1)",fill:!0,tension:.4,pointRadius:4,pointHoverRadius:6}]};return{name:e.name,latest:t,previous:i,comparison:n,chartData:r}}).filter(Boolean):[],[b,p]),N=(0,t.useMemo)(()=>{if(0===u.length)return[];const e=[...u].sort((e,a)=>new Date(e.date)-new Date(a.date)),a=[],s={labels:e.map(e=>new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Weight (kg)",data:e.map(e=>e.weight),borderColor:"#a78bfa",backgroundColor:"rgba(167, 139, 250, 0.15)",fill:!0,tension:.4,borderWidth:3,pointRadius:6,pointBackgroundColor:"#1e293b",pointBorderColor:"#a78bfa",pointBorderWidth:3,pointHoverRadius:8,pointHoverBackgroundColor:"#a78bfa",pointHoverBorderColor:"#fff"}]};a.push({name:"Weight",data:s,unit:"kg"});const t=e.filter(e=>e.bodyFatPercentage);if(t.length>0){const e={labels:t.map(e=>new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Body Fat %",data:t.map(e=>e.bodyFatPercentage),borderColor:"#f472b6",backgroundColor:"rgba(244, 114, 182, 0.15)",fill:!0,tension:.4,borderWidth:3,pointRadius:6,pointBackgroundColor:"#1e293b",pointBorderColor:"#f472b6",pointBorderWidth:3,pointHoverRadius:8,pointHoverBackgroundColor:"#f472b6",pointHoverBorderColor:"#fff"}]};a.push({name:"Body Fat",data:e,unit:"%"})}const i=e.filter(e=>e.waist);if(i.length>0){const e={labels:i.map(e=>new Date(e.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),datasets:[{label:"Waist (cm)",data:i.map(e=>e.waist),borderColor:"#c084fc",backgroundColor:"rgba(192, 132, 252, 0.15)",fill:!0,tension:.4,borderWidth:3,pointRadius:6,pointBackgroundColor:"#1e293b",pointBorderColor:"#c084fc",pointBorderWidth:3,pointHoverRadius:8,pointHoverBackgroundColor:"#c084fc",pointHoverBorderColor:"#fff"}]};a.push({name:"Waist",data:e,unit:"cm"})}return a},[u]),y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},w={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return(0,m.jsxs)(c.P.div,{className:"progress-page-enhanced system-ui",variants:y,initial:"hidden",animate:"visible",children:[(0,m.jsx)("header",{className:"progress-header",children:(0,m.jsxs)("div",{className:"header-left",children:[(0,m.jsx)(h.A,{}),(0,m.jsxs)("div",{children:[(0,m.jsx)("h2",{children:"Performance Analytics"}),(0,m.jsx)("p",{className:"sub",children:"Deep dive into your training progress"})]})]})}),(0,m.jsxs)(c.P.section,{className:"analysis-controls-card",variants:w,children:[(0,m.jsxs)("div",{className:"control-group",children:[(0,m.jsxs)("label",{children:[(0,m.jsx)(d.RBv,{})," Select Template"]}),(0,m.jsx)("div",{className:"select-wrapper",children:(0,m.jsxs)("select",{className:"modern-select",value:(null===p||void 0===p?void 0:p._id)||"",onChange:e=>{const a=s.find(a=>a._id===e.target.value);g(a)},children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Choose a template..."}),s.map(e=>(0,m.jsx)("option",{value:e._id,children:e.templateName},e._id))]})})]}),p&&(0,m.jsxs)("div",{className:"control-group",children:[(0,m.jsxs)("label",{children:[(0,m.jsx)(d.bfZ,{})," Time Range"]}),(0,m.jsx)("div",{className:"time-filters",children:["week","month","year","all"].map(e=>(0,m.jsx)("button",{className:"filter-btn ".concat(x===e?"active":""),onClick:()=>f(e),children:"all"===e?"All Time":"Last ".concat(e.charAt(0).toUpperCase()+e.slice(1))},e))})]})]}),(0,m.jsx)("div",{className:"analytics-content",children:p?(0,m.jsx)(c.P.div,{className:"exercise-analytics-grid",variants:y,children:j.length>0?j.map((e,a)=>{const s=a%2!==0;return(0,m.jsxs)(c.P.div,{className:"exercise-row ".concat(s?"right":"left"),initial:{opacity:0,x:s?50:-50},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.5,delay:.1*a},children:[(0,m.jsxs)("div",{className:"exercise-analysis-card",children:[(0,m.jsxs)("div",{className:"card-header",children:[(0,m.jsx)("h3",{children:e.name}),(0,m.jsxs)("span",{className:"badge",children:["Total Volume: ",e.latest.volume]})]}),(0,m.jsxs)("div",{className:"current-stats-row",children:[(0,m.jsxs)("div",{className:"stat-pill",children:[(0,m.jsx)("span",{className:"label",children:"Weight"}),(0,m.jsxs)("span",{className:"value",children:[e.latest.weight,"kg"]})]}),(0,m.jsxs)("div",{className:"stat-pill",children:[(0,m.jsx)("span",{className:"label",children:"Sets x Reps"}),(0,m.jsxs)("span",{className:"value",children:[e.latest.sets," x ",e.latest.reps]})]})]}),(0,m.jsx)("div",{className:"mini-chart-container",children:(0,m.jsx)(i.N1,{data:e.chartData,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(139, 92, 246, 0.9)",titleColor:"#fff",bodyColor:"#fff",padding:12,cornerRadius:8,displayColors:!1,callbacks:{label:e=>" ".concat(e.parsed.y," kg")}}},scales:{x:{display:!1},y:{display:!0,grid:{color:"rgba(138, 43, 226, 0.1)"},ticks:{color:"rgba(148, 163, 184, 0.8)"}}}}})})]}),(0,m.jsxs)("div",{className:"side-insight-card",children:[(0,m.jsx)("h4",{children:"Quick Insights"}),e.comparison?(0,m.jsxs)("div",{className:"insight-content",children:[(0,m.jsxs)("div",{className:"insight-item",children:[(0,m.jsx)("span",{children:"vs Last Session"}),(0,m.jsxs)("div",{className:"diff-tag ".concat(e.comparison.weightDiff>=0?"pos":"neg"),children:[e.comparison.weightDiff>0?"+":"",e.comparison.weightDiff,"kg"]})]}),(0,m.jsxs)("div",{className:"insight-item",children:[(0,m.jsx)("span",{children:"Volume Change"}),(0,m.jsxs)("div",{className:"diff-tag ".concat(e.comparison.volumeChange>=0?"pos":"neg"),children:[e.comparison.volumeChange>0?"+":"",e.comparison.volumeChange,"%"]})]}),(0,m.jsx)("p",{className:"insight-tip",children:e.comparison.volumeChange>0?"Great progress! You're overloading effectively.":"Keep pushing! Consistency is key."})]}):(0,m.jsx)("p",{className:"insight-tip",children:"Not enough data for insights yet. Keep logging!"})]})]},a)}):(0,m.jsx)("div",{className:"no-data-msg",children:"No workouts found for this time range."})}):(0,m.jsxs)(c.P.div,{className:"select-prompt",variants:w,children:[(0,m.jsx)(d.YYR,{size:48}),(0,m.jsx)("h3",{children:"Select a template to view advanced analytics"})]})}),N.length>0&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(c.P.div,{className:"page-title",variants:w,style:{marginTop:"3rem"},children:[(0,m.jsx)("h2",{children:"Body Metrics Progress"}),(0,m.jsx)("p",{children:"Track your physical transformation over time"})]}),(0,m.jsx)(c.P.div,{className:"charts-grid-enhanced",variants:y,children:N.map((e,a)=>(0,m.jsxs)(c.P.div,{className:"chart-card-enhanced",variants:w,whileHover:{y:-8},children:[(0,m.jsxs)("div",{className:"chart-header",children:[(0,m.jsx)("h3",{children:e.name}),(0,m.jsx)("div",{className:"chart-badge",children:e.unit})]}),e.data.labels.length>0?(0,m.jsx)("div",{className:"chart-container",children:(0,m.jsx)(i.N1,{data:e.data,options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(138, 43, 226, 0.8)",padding:12,borderRadius:8,titleFont:{size:12,weight:"bold"},bodyFont:{size:11},callbacks:{label:a=>" ".concat(a.parsed.y.toFixed(1)," ").concat(e.unit)}}},scales:{y:{beginAtZero:!1,grid:{color:"rgba(138, 43, 226, 0.1)"},ticks:{color:"rgba(240, 242, 245, 0.7)"}},x:{grid:{display:!1},ticks:{color:"rgba(240, 242, 245, 0.7)"}}}}})}):(0,m.jsx)("div",{className:"no-data",children:(0,m.jsx)("p",{children:"\ud83d\udcca Log more metrics to see your progression"})})]},e.name))})]})]})}},6801:(e,a,s)=>{s.d(a,{A:()=>o});s(5043);var t=s(9981),i=s(6446),n=s(3204),r=s(579);const o=e=>{let{label:a="Back",className:s=""}=e;const o=(0,t.Zp)();return(0,r.jsxs)(i.P.button,{className:"back-button-nav ".concat(s),onClick:()=>o(-1),whileHover:{x:-3},whileTap:{scale:.95},children:[(0,r.jsx)(n.QVr,{}),(0,r.jsx)("span",{children:a})]})}}}]);
//# sourceMappingURL=194.07e21653.chunk.js.map