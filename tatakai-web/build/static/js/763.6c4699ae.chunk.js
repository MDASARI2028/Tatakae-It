"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[763],{1763:(e,t,s)=>{s.r(t),s.d(t,{default:()=>N});var a=s(5043),i=s(697),n=s(2524),r=s(8109),o=s(6446),c=s(3546),l=s(3204),d=s(579);const u=e=>{let{filterDate:t,setFilterDate:s,onEdit:i,showToast:u}=e;const{workouts:m,loading:h,deleteWorkout:x}=(0,a.useContext)(n.Z),{saveAsTemplate:p}=(0,a.useContext)(r.m),j=(()=>{const e=new Date,t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(s,"-").concat(a)})(),v=(0,a.useMemo)(()=>{const e={};return[...m].sort((e,t)=>new Date(e.date)-new Date(t.date)).forEach(t=>{t.exercises&&t.exercises.forEach(s=>{var a;const i=null===(a=s.name)||void 0===a?void 0:a.toLowerCase().trim();if(!i)return;e[i]||(e[i]=[]);const n=(Number(s.sets)||0)*(Number(s.reps)||0)*(Number(s.weight)||1);e[i].push({workoutId:t._id,date:t.date,sets:Number(s.sets)||0,reps:Number(s.reps)||0,weight:Number(s.weight)||0,volume:n})})}),(t,s)=>{const a=null===s||void 0===s?void 0:s.toLowerCase().trim();if(!a||!e[a])return null;const i=e[a],n=i.findIndex(e=>e.workoutId===t);if(n<=0)return null;const r=i[n],o=i[n-1];if(0===o.volume)return null;const c=(r.volume-o.volume)/o.volume*100;return{change:Math.round(c),improved:c>0,currentVolume:r.volume,previousVolume:o.volume}}},[m]),g=(0,a.useMemo)(()=>{const e=t||j;return m.filter(t=>(e=>{if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return e;const s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(i)})(t.date)===e)},[m,t,j]),y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},N={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.4}},exit:{opacity:0,x:100,transition:{duration:.2}}};return h?(0,d.jsxs)("div",{className:"loading-state",children:[(0,d.jsx)("div",{className:"spinner"}),(0,d.jsx)("p",{children:"Loading workout history..."})]}):(0,d.jsxs)(o.P.div,{className:"workout-history-enhanced",variants:y,initial:"hidden",animate:"visible",children:[(0,d.jsxs)("div",{className:"history-controls",children:[(0,d.jsxs)("label",{className:"date-picker-label",children:[(0,d.jsx)("span",{className:"icon",children:"\ud83d\udcc5"}),(0,d.jsx)("input",{type:"date",value:t,onChange:e=>s(e.target.value),className:"modern-date-input"})]}),t&&(0,d.jsx)("button",{className:"clear-filter-btn",onClick:()=>s(""),children:"Show All"})]}),0===g.length?(0,d.jsxs)(o.P.div,{className:"empty-message",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,d.jsx)(l.bB,{className:"empty-icon"}),(0,d.jsx)("p",{children:"No workouts logged for this date yet!"}),(0,d.jsx)("span",{children:"Start logging to track your progress"})]}):(0,d.jsx)(o.P.ul,{className:"workout-list-enhanced",variants:y,children:(0,d.jsx)(c.N,{children:g.map(e=>{const t=(e=>{if(!e.exercises||0===e.exercises.length||"Cardio"===e.type)return null;let t=0,s=0;if(e.exercises.forEach(a=>{const i=v(e._id,a.name);i&&null!==i.change&&(t+=i.change,s++)}),0===s)return null;const a=t/s;return{average:Math.round(a),improved:a>0,exercisesCompared:s,totalExercises:e.exercises.length}})(e);return(0,d.jsxs)(o.P.li,{className:"workout-item-enhanced",variants:N,exit:"exit",children:[(0,d.jsx)("div",{className:"workout-header",children:(0,d.jsxs)("div",{className:"workout-title-section",children:[(0,d.jsx)("h3",{children:(s=e.date,new Date(s).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}))}),(0,d.jsx)("span",{className:"workout-type-badge",children:e.type||"Workout"}),t&&(0,d.jsxs)("span",{className:"workout-overload-badge ".concat(t.improved?"improved":"declined"),title:"".concat(t.exercisesCompared,"/").concat(t.totalExercises," exercises compared"),children:[t.improved?(0,d.jsx)(l.uCC,{}):(0,d.jsx)(l.$TP,{}),Math.abs(t.average),"% avg"]})]})}),e.notes&&(0,d.jsxs)("div",{className:"workout-notes-display",children:[(0,d.jsx)("span",{className:"note-icon",children:"\ud83d\udcac"}),(0,d.jsx)("p",{children:e.notes})]}),e.exercises&&e.exercises.length>0&&(0,d.jsxs)(o.P.div,{className:"exercise-details-enhanced",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{delay:.1},children:[(0,d.jsx)("h4",{children:"Cardio"===e.type?"\ud83c\udfc3 Cardio Exercises":"\ud83c\udfcb\ufe0f Exercises"}),(0,d.jsx)("ul",{className:"exercises-list",children:e.exercises.map((t,s)=>{const a="Cardio"!==e.type?v(e._id,t.name):null;return(0,d.jsxs)(o.P.li,{className:"exercise-item",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1+.05*s},children:[(0,d.jsx)("span",{className:"exercise-name",children:t.name}),(0,d.jsx)("span",{className:"exercise-stats",children:"Cardio"===e.type?"".concat(t.duration||0," min \u2022 ").concat(t.caloriesBurned||0," cal"):"".concat(t.sets,"\xd7").concat(t.reps," @ ").concat(t.weight,"kg")}),a&&(0,d.jsxs)("span",{className:"progressive-overload ".concat(a.improved?"improved":"declined"),title:"Volume: ".concat(a.currentVolume," vs ").concat(a.previousVolume," (previous)"),children:[a.improved?(0,d.jsx)(l.uCC,{}):(0,d.jsx)(l.$TP,{}),Math.abs(a.change),"%"]})]},s)})})]}),(0,d.jsxs)(o.P.div,{className:"workout-actions-enhanced",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,d.jsxs)(o.P.button,{className:"action-button edit-button-enhanced",onClick:()=>i(e),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Edit Workout",children:[(0,d.jsx)(l.uO9,{})," Edit"]}),(0,d.jsxs)(o.P.button,{className:"action-button template-button-enhanced",onClick:()=>(async e=>{const t=await p(e);t&&t.success?u("Template saved successfully!","success"):t&&!t.success&&u(t.error||"Failed to save template.","error")})(e),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Save as Template",children:[(0,d.jsx)(l.WCW,{})," Template"]}),(0,d.jsxs)(o.P.button,{className:"action-button delete-button-enhanced",onClick:()=>(async e=>{const t=await x(e);t&&t.success?u("Workout deleted successfully!","success"):t&&!t.success&&u("Failed to delete workout.","error")})(e._id),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Delete Workout",children:[(0,d.jsx)(l.qbC,{})," Delete"]})]})]},e._id);var s})})})]})},m=e=>{let{metrics:t}=e;return(0,d.jsxs)("div",{className:"metric-history",children:[(0,d.jsx)("h3",{children:"Metrics History"}),0===t.length?(0,d.jsx)("p",{children:"No metrics logged yet."}):(0,d.jsx)("ul",{className:"metric-list",children:t.map(e=>{return(0,d.jsxs)("li",{className:"metric-item",children:[(0,d.jsx)("strong",{children:(t=e.date,new Date(t).toLocaleDateString())}),(0,d.jsxs)("div",{children:["Weight: ",e.weight," kg"]}),e.bodyFatPercentage&&(0,d.jsxs)("div",{children:["Body Fat: ",e.bodyFatPercentage,"%"]}),e.waist&&(0,d.jsxs)("div",{children:["Waist: ",e.waist," cm"]})]},e._id);var t})})]})};var h=s(9379);const x=e=>{let{workout:t,onClose:s,showToast:i}=e;const{updateWorkout:r}=(0,a.useContext)(n.Z),[c,u]=(0,a.useState)({date:new Date(t.date).toISOString().slice(0,10),type:t.type,duration:t.duration,notes:t.notes||""}),[m,x]=(0,a.useState)(JSON.parse(JSON.stringify(t.exercises))),[p,j]=(0,a.useState)(!1),v=e=>u((0,h.A)((0,h.A)({},c),{},{[e.target.name]:e.target.value})),g=(e,t)=>{const s=m.map((s,a)=>a===e?(0,h.A)((0,h.A)({},s),{},{[t.target.name]:t.target.value}):s);x(s)};return(0,d.jsx)(o.P.div,{className:"modal-backdrop",onClick:s,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,d.jsxs)(o.P.div,{className:"modal-content",onClick:e=>e.stopPropagation(),initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[(0,d.jsx)("h2",{children:"\u270f\ufe0f Edit Workout"}),(0,d.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j(!0);const a=(0,h.A)((0,h.A)({},c),{},{exercises:m});(await r(t._id,a)).success?(i("Workout updated successfully!","success"),s()):i("Failed to update workout. Please try again.","error"),j(!1)},className:"workout-logger-form",children:[(0,d.jsxs)("div",{className:"form-grid",children:[(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.itz,{})," Date"]}),(0,d.jsx)("input",{type:"date",name:"date",className:"form-input",value:c.date,onChange:v,required:!0})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.bB,{})," Type"]}),(0,d.jsxs)("select",{name:"type",className:"form-select",value:c.type,onChange:v,children:[(0,d.jsx)("option",{value:"Strength Training",children:"Strength Training"}),(0,d.jsx)("option",{value:"Cardio",children:"Cardio"}),(0,d.jsx)("option",{value:"Other",children:"Other"})]})]})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.w_X,{})," Duration (minutes)"]}),(0,d.jsx)("input",{type:"number",name:"duration",className:"form-input",placeholder:"Duration (mins)",value:c.duration,onChange:v,min:"1",required:!0})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.jie,{})," Notes"]}),(0,d.jsx)("textarea",{name:"notes",className:"form-textarea",placeholder:"Add any notes about your workout...",value:c.notes,onChange:v})]}),(0,d.jsxs)("div",{className:"exercises-list-container",children:[(0,d.jsx)("h4",{children:"\ud83c\udfcb\ufe0f Exercises"}),m.map((e,t)=>(0,d.jsxs)(o.P.div,{className:"exercise-grid",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},children:[(0,d.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Exercise Name",value:e.name,onChange:e=>g(t,e),required:!0}),(0,d.jsx)("input",{type:"number",name:"sets",className:"form-input",placeholder:"Sets",value:e.sets,onChange:e=>g(t,e),min:"1"}),(0,d.jsx)("input",{type:"number",name:"reps",className:"form-input",placeholder:"Reps",value:e.reps,onChange:e=>g(t,e),min:"1"}),(0,d.jsx)("input",{type:"number",name:"weight",className:"form-input",placeholder:"Weight (kg)",value:e.weight,onChange:e=>g(t,e),min:"0"}),(0,d.jsx)("button",{type:"button",className:"remove-exercise-btn",onClick:()=>(e=>{m.length>1&&x(m.filter((t,s)=>s!==e))})(t),title:"Remove exercise",children:(0,d.jsx)(l.QCr,{})})]},t)),(0,d.jsxs)(o.P.button,{type:"button",className:"system-button btn-secondary",onClick:()=>x([...m,{name:"",sets:3,reps:10,weight:10}]),whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,d.jsx)(l.OiG,{})," Add Exercise"]})]}),(0,d.jsxs)("div",{className:"modal-actions",children:[(0,d.jsx)(o.P.button,{type:"button",className:"system-button btn-secondary",onClick:s,whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"}),(0,d.jsx)(o.P.button,{type:"submit",className:"system-button btn-primary",disabled:p,whileHover:{scale:1.02},whileTap:{scale:.98},children:p?"Saving...":"Save Changes"})]})]})]})})},p=e=>{let{message:t,type:s="success",onClose:i,duration:n=3e3}=e;(0,a.useEffect)(()=>{const e=setTimeout(()=>{i()},n);return()=>clearTimeout(e)},[n,i]);const r={success:(0,d.jsx)(l.A7C,{}),error:(0,d.jsx)(l.TNq,{}),info:(0,d.jsx)(l.__w,{})};return(0,d.jsxs)(o.P.div,{className:"toast toast-".concat(s),initial:{opacity:0,y:-50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.5,transition:{duration:.2}},children:[(0,d.jsx)("div",{className:"toast-icon",children:r[s]}),(0,d.jsx)("div",{className:"toast-message",children:t}),(0,d.jsx)("button",{className:"toast-close",onClick:i,children:(0,d.jsx)(l.QCr,{})})]})},j=e=>{let{toasts:t,removeToast:s}=e;return(0,d.jsx)("div",{className:"toast-container",children:(0,d.jsx)(c.N,{children:t.map(e=>(0,d.jsx)(p,{message:e.message,type:e.type,onClose:()=>s(e.id),duration:e.duration},e.id))})})};let v=0;const g=()=>{const[e,t]=(0,a.useState)([]);return{toasts:e,addToast:(0,a.useCallback)(function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const i=v++;t(t=>[...t,{id:i,message:e,type:s,duration:a}])},[]),removeToast:(0,a.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[])}};var y=s(6801);const N=()=>{const{token:e}=(0,a.useContext)(i.c),[t,s]=(0,a.useState)([]),[n,r]=(0,a.useState)(""),{toasts:o,addToast:c,removeToast:l}=g(),[h,p]=(0,a.useState)(!1),[v,N]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(e)try{const t=await fetch("/api/metrics?limit=100",{headers:{"x-auth-token":e}});if(t.ok){const e=await t.json();s(e)}}catch(t){console.error("Failed to fetch metrics:",t)}})()},[e]);const w=n?t.filter(e=>(e=>{const t=new Date(e),s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(i)})(e.date)===n):t.slice(0,1);return(0,d.jsxs)("div",{children:[(0,d.jsx)(j,{toasts:o,removeToast:l}),(0,d.jsxs)("div",{className:"history-page-header",style:{marginBottom:"1rem"},children:[(0,d.jsx)(y.A,{}),(0,d.jsx)("h2",{children:"History & Logs"})]}),(0,d.jsxs)("div",{className:"history-grid-container",children:[(0,d.jsxs)("div",{className:"history-section",children:[(0,d.jsx)("h3",{children:"Workout History"}),(0,d.jsx)(u,{filterDate:n,setFilterDate:r,onEdit:e=>{N(e),p(!0)},showToast:c})]}),(0,d.jsxs)("div",{className:"history-section",children:[(0,d.jsx)("h3",{children:"Body Metric History"}),(0,d.jsx)(m,{metrics:w})]})]}),h&&(0,d.jsx)(x,{workout:v,onClose:()=>{N(null),p(!1)},showToast:c})]})}},6801:(e,t,s)=>{s.d(t,{A:()=>o});s(5043);var a=s(9981),i=s(6446),n=s(3204),r=s(579);const o=e=>{let{label:t="Back",className:s=""}=e;const o=(0,a.Zp)();return(0,r.jsxs)(i.P.button,{className:"back-button-nav ".concat(s),onClick:()=>o(-1),whileHover:{x:-3},whileTap:{scale:.95},children:[(0,r.jsx)(n.QVr,{}),(0,r.jsx)("span",{children:t})]})}}}]);
//# sourceMappingURL=763.6c4699ae.chunk.js.map