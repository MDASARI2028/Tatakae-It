"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[763],{1763:(e,s,t)=>{t.r(s),t.d(s,{default:()=>N});var a=t(5043),i=t(697),n=t(2524),r=t(8109),o=t(6446),c=t(3546),l=t(184),d=t(579);const u=e=>{let{filterDate:s,setFilterDate:t,onEdit:i,showToast:u}=e;const{workouts:m,loading:h,deleteWorkout:x}=(0,a.useContext)(n.Z),{saveAsTemplate:p}=(0,a.useContext)(r.m),j=(()=>{const e=new Date,s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(s,"-").concat(t,"-").concat(a)})(),v=(0,a.useMemo)(()=>{const e={};return[...m].sort((e,s)=>new Date(e.date)-new Date(s.date)).forEach(s=>{if(!s.exercises)return;const t={};s.exercises.forEach(e=>{var s;const a=null===(s=e.name)||void 0===s?void 0:s.toLowerCase().trim();if(!a)return;t[a]||(t[a]=0);let i=0;if(e.setsData&&e.setsData.length>0)i=e.setsData.reduce((e,s)=>{const t=Number(s.weight)||0;return e+(Number(s.reps)||0)*t},0),0===i&&(i=e.setsData.reduce((e,s)=>e+1*(Number(s.reps)||0),0));else{const s=Number(e.weight)||1;i=(Number(e.sets)||0)*(Number(e.reps)||0)*s}t[a]+=i}),Object.keys(t).forEach(a=>{e[a]||(e[a]=[]),e[a].push({workoutId:s._id,date:s.date,volume:t[a]})})}),(s,t)=>{const a=null===t||void 0===t?void 0:t.toLowerCase().trim();if(!a||!e[a])return null;const i=e[a],n=i.findIndex(e=>e.workoutId===s);if(n<=0)return null;const r=i[n],o=i[n-1];if(0===o.volume)return null;const c=(r.volume-o.volume)/o.volume*100;return{change:Math.round(c),improved:c>0,currentVolume:r.volume,previousVolume:o.volume}}},[m]),g=(0,a.useMemo)(()=>{const e=s||j;return m.filter(s=>(e=>{if(!e)return"";const s=new Date(e);if(isNaN(s.getTime()))return e;const t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(i)})(s.date)===e)},[m,s,j]),y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},N={hidden:{opacity:0,x:-20},visible:{opacity:1,x:0,transition:{duration:.4}},exit:{opacity:0,x:100,transition:{duration:.2}}};return h?(0,d.jsxs)("div",{className:"loading-state",children:[(0,d.jsx)("div",{className:"spinner"}),(0,d.jsx)("p",{children:"Loading workout history..."})]}):(0,d.jsxs)(o.P.div,{className:"workout-history-enhanced",variants:y,initial:"hidden",animate:"visible",children:[(0,d.jsxs)("div",{className:"history-controls",children:[(0,d.jsxs)("label",{className:"date-picker-label",children:[(0,d.jsx)("span",{className:"icon",children:"\ud83d\udcc5"}),(0,d.jsx)("input",{type:"date",value:s,onChange:e=>t(e.target.value),className:"modern-date-input"})]}),s&&(0,d.jsx)("button",{className:"clear-filter-btn",onClick:()=>t(""),children:"Show All"})]}),0===g.length?(0,d.jsxs)(o.P.div,{className:"empty-message",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,d.jsx)(l.bB,{className:"empty-icon"}),(0,d.jsx)("p",{children:"No workouts logged for this date yet!"}),(0,d.jsx)("span",{children:"Start logging to track your progress"})]}):(0,d.jsx)(o.P.ul,{className:"workout-list-enhanced",variants:y,children:(0,d.jsx)(c.N,{children:g.map(e=>{const s=(e=>{if(!e.exercises||0===e.exercises.length||"Cardio"===e.type)return null;let s=0,t=0;if(e.exercises.forEach(a=>{const i=v(e._id,a.name);i&&null!==i.change&&(s+=i.change,t++)}),0===t)return null;const a=s/t;return{average:Math.round(a),improved:a>0,exercisesCompared:t,totalExercises:e.exercises.length}})(e);return(0,d.jsxs)(o.P.li,{className:"workout-item-enhanced",variants:N,exit:"exit",children:[(0,d.jsx)("div",{className:"workout-header",children:(0,d.jsxs)("div",{className:"workout-title-section",children:[(0,d.jsx)("h3",{children:(t=e.date,new Date(t).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}))}),(0,d.jsx)("span",{className:"workout-type-badge",children:e.type||"Workout"}),s&&(0,d.jsxs)("span",{className:"workout-overload-badge ".concat(s.improved?"improved":"declined"),title:"".concat(s.exercisesCompared,"/").concat(s.totalExercises," exercises compared"),children:[s.improved?(0,d.jsx)(l.uCC,{}):(0,d.jsx)(l.$TP,{}),Math.abs(s.average),"% avg"]})]})}),e.notes&&(0,d.jsxs)("div",{className:"workout-notes-display",children:[(0,d.jsx)("span",{className:"note-icon",children:"\ud83d\udcac"}),(0,d.jsx)("p",{children:e.notes})]}),e.exercises&&e.exercises.length>0&&(0,d.jsxs)(o.P.div,{className:"exercise-details-enhanced",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{delay:.1},children:[(0,d.jsx)("h4",{children:"Cardio"===e.type?"\ud83c\udfc3 Cardio Exercises":"\ud83c\udfcb\ufe0f Exercises"}),(0,d.jsx)("ul",{className:"exercises-list",children:e.exercises.map((s,t)=>{const a="Cardio"!==e.type?v(e._id,s.name):null;return(0,d.jsxs)(o.P.li,{className:"exercise-item",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1+.05*t},children:[(0,d.jsx)("span",{className:"exercise-name",children:s.name}),(0,d.jsx)("span",{className:"exercise-stats",children:"Cardio"===e.type?"".concat(s.duration||0," min \u2022 ").concat(s.caloriesBurned||0," cal"):s.setsData&&s.setsData.length>0?(0,d.jsx)("span",{className:"sets-detail-list",children:s.setsData.map((e,t)=>(0,d.jsxs)("span",{className:"set-tag",children:[e.reps||0,"x",e.weight||0,"kg",t<s.setsData.length-1?", ":""]},t))}):"".concat(s.sets||0," sets \xd7 ").concat(s.reps||0," reps @ ").concat(s.weight||0,"kg")}),a&&(0,d.jsxs)("span",{className:"progressive-overload ".concat(a.improved?"improved":"declined"),title:"Volume: ".concat(a.currentVolume," vs ").concat(a.previousVolume," (previous)"),children:[a.improved?(0,d.jsx)(l.uCC,{}):(0,d.jsx)(l.$TP,{}),Math.abs(a.change),"%"]})]},t)})})]}),(0,d.jsxs)(o.P.div,{className:"workout-actions-enhanced",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},children:[(0,d.jsxs)(o.P.button,{className:"action-button edit-button-enhanced",onClick:()=>i(e),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Edit Workout",children:[(0,d.jsx)(l.uO9,{})," Edit"]}),(0,d.jsxs)(o.P.button,{className:"action-button template-button-enhanced",onClick:()=>(async e=>{const s=await p(e);s&&s.success?u("Template saved successfully!","success"):s&&!s.success&&u(s.error||"Failed to save template.","error")})(e),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Save as Template",children:[(0,d.jsx)(l.WCW,{})," Template"]}),(0,d.jsxs)(o.P.button,{className:"action-button delete-button-enhanced",onClick:()=>(async e=>{const s=await x(e);s&&s.success?u("Workout deleted successfully!","success"):s&&!s.success&&u("Failed to delete workout.","error")})(e._id),whileHover:{scale:1.05},whileTap:{scale:.95},title:"Delete Workout",children:[(0,d.jsx)(l.qbC,{})," Delete"]})]})]},e._id);var t})})})]})},m=e=>{let{metrics:s}=e;return(0,d.jsxs)("div",{className:"metric-history",children:[(0,d.jsx)("h3",{children:"Metrics History"}),0===s.length?(0,d.jsx)("p",{children:"No metrics logged yet."}):(0,d.jsx)("ul",{className:"metric-list",children:s.map(e=>{return(0,d.jsxs)("li",{className:"metric-item",children:[(0,d.jsx)("strong",{children:(s=e.date,new Date(s).toLocaleDateString())}),(0,d.jsxs)("div",{children:["Weight: ",e.weight," kg"]}),e.bodyFatPercentage&&(0,d.jsxs)("div",{children:["Body Fat: ",e.bodyFatPercentage,"%"]}),e.waist&&(0,d.jsxs)("div",{children:["Waist: ",e.waist," cm"]})]},e._id);var s})})]})};var h=t(9379);const x=e=>{let{workout:s,onClose:t,showToast:i}=e;const{updateWorkout:r}=(0,a.useContext)(n.Z),[c,u]=(0,a.useState)({date:new Date(s.date).toISOString().slice(0,10),type:s.type,duration:s.duration,notes:s.notes||""}),[m,x]=(0,a.useState)(JSON.parse(JSON.stringify(s.exercises))),[p,j]=(0,a.useState)(!1),v=e=>u((0,h.A)((0,h.A)({},c),{},{[e.target.name]:e.target.value})),g=(e,s)=>{const t=m.map((t,a)=>a===e?(0,h.A)((0,h.A)({},t),{},{[s.target.name]:s.target.value}):t);x(t)};return(0,d.jsx)(o.P.div,{className:"modal-backdrop",onClick:t,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,d.jsxs)(o.P.div,{className:"modal-content",onClick:e=>e.stopPropagation(),initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},children:[(0,d.jsx)("h2",{children:"\u270f\ufe0f Edit Workout"}),(0,d.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),j(!0);const a=(0,h.A)((0,h.A)({},c),{},{exercises:m});(await r(s._id,a)).success?(i("Workout updated successfully!","success"),t()):i("Failed to update workout. Please try again.","error"),j(!1)},className:"workout-logger-form",children:[(0,d.jsxs)("div",{className:"form-grid",children:[(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.itz,{})," Date"]}),(0,d.jsx)("input",{type:"date",name:"date",className:"form-input",value:c.date,onChange:v,required:!0})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.bB,{})," Type"]}),(0,d.jsxs)("select",{name:"type",className:"form-select",value:c.type,onChange:v,children:[(0,d.jsx)("option",{value:"Strength Training",children:"Strength Training"}),(0,d.jsx)("option",{value:"Cardio",children:"Cardio"}),(0,d.jsx)("option",{value:"Other",children:"Other"})]})]})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.w_X,{})," Duration (minutes)"]}),(0,d.jsx)("input",{type:"number",name:"duration",className:"form-input",placeholder:"Duration (mins)",value:c.duration,onChange:v,min:"1",required:!0})]}),(0,d.jsxs)("div",{className:"form-field",children:[(0,d.jsxs)("label",{children:[(0,d.jsx)(l.jie,{})," Notes"]}),(0,d.jsx)("textarea",{name:"notes",className:"form-textarea",placeholder:"Add any notes about your workout...",value:c.notes,onChange:v})]}),(0,d.jsxs)("div",{className:"exercises-list-container",children:[(0,d.jsx)("h4",{children:"\ud83c\udfcb\ufe0f Exercises"}),m.map((e,s)=>(0,d.jsxs)(o.P.div,{className:"exercise-grid",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*s},children:[(0,d.jsx)("input",{type:"text",name:"name",className:"form-input",placeholder:"Exercise Name",value:e.name,onChange:e=>g(s,e),required:!0}),(0,d.jsx)("input",{type:"number",name:"sets",className:"form-input",placeholder:"Sets",value:e.sets,onChange:e=>g(s,e),min:"1"}),(0,d.jsx)("input",{type:"number",name:"reps",className:"form-input",placeholder:"Reps",value:e.reps,onChange:e=>g(s,e),min:"1"}),(0,d.jsx)("input",{type:"number",name:"weight",className:"form-input",placeholder:"Weight (kg)",value:e.weight,onChange:e=>g(s,e),min:"0"}),(0,d.jsx)("button",{type:"button",className:"remove-exercise-btn",onClick:()=>(e=>{m.length>1&&x(m.filter((s,t)=>t!==e))})(s),title:"Remove exercise",children:(0,d.jsx)(l.QCr,{})})]},s)),(0,d.jsxs)(o.P.button,{type:"button",className:"system-button btn-secondary",onClick:()=>x([...m,{name:"",sets:3,reps:10,weight:10}]),whileHover:{scale:1.02},whileTap:{scale:.98},children:[(0,d.jsx)(l.OiG,{})," Add Exercise"]})]}),(0,d.jsxs)("div",{className:"modal-actions",children:[(0,d.jsx)(o.P.button,{type:"button",className:"system-button btn-secondary",onClick:t,whileHover:{scale:1.02},whileTap:{scale:.98},children:"Cancel"}),(0,d.jsx)(o.P.button,{type:"submit",className:"system-button btn-primary",disabled:p,whileHover:{scale:1.02},whileTap:{scale:.98},children:p?"Saving...":"Save Changes"})]})]})]})})},p=e=>{let{message:s,type:t="success",onClose:i,duration:n=3e3}=e;(0,a.useEffect)(()=>{const e=setTimeout(()=>{i()},n);return()=>clearTimeout(e)},[n,i]);const r={success:(0,d.jsx)(l.A7C,{}),error:(0,d.jsx)(l.TNq,{}),info:(0,d.jsx)(l.__w,{})};return(0,d.jsxs)(o.P.div,{className:"toast toast-".concat(t),initial:{opacity:0,y:-50,scale:.3},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,scale:.5,transition:{duration:.2}},children:[(0,d.jsx)("div",{className:"toast-icon",children:r[t]}),(0,d.jsx)("div",{className:"toast-message",children:s}),(0,d.jsx)("button",{className:"toast-close",onClick:i,children:(0,d.jsx)(l.QCr,{})})]})},j=e=>{let{toasts:s,removeToast:t}=e;return(0,d.jsx)("div",{className:"toast-container",children:(0,d.jsx)(c.N,{children:s.map(e=>(0,d.jsx)(p,{message:e.message,type:e.type,onClose:()=>t(e.id),duration:e.duration},e.id))})})};let v=0;const g=()=>{const[e,s]=(0,a.useState)([]);return{toasts:e,addToast:(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;const i=v++;s(s=>[...s,{id:i,message:e,type:t,duration:a}])},[]),removeToast:(0,a.useCallback)(e=>{s(s=>s.filter(s=>s.id!==e))},[])}};var y=t(6801);const N=()=>{const{token:e}=(0,a.useContext)(i.c),[s,t]=(0,a.useState)([]),[n,r]=(0,a.useState)(""),{toasts:o,addToast:c,removeToast:l}=g(),[h,p]=(0,a.useState)(!1),[v,N]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{if(e)try{const s=await fetch("/api/metrics?limit=100",{headers:{"x-auth-token":e}});if(s.ok){const e=await s.json();t(e)}}catch(s){console.error("Failed to fetch metrics:",s)}})()},[e]);const w=n?s.filter(e=>(e=>{const s=new Date(e),t=s.getFullYear(),a=String(s.getMonth()+1).padStart(2,"0"),i=String(s.getDate()).padStart(2,"0");return"".concat(t,"-").concat(a,"-").concat(i)})(e.date)===n):s.slice(0,1);return(0,d.jsxs)("div",{children:[(0,d.jsx)(j,{toasts:o,removeToast:l}),(0,d.jsxs)("div",{className:"history-page-header",style:{marginBottom:"1rem"},children:[(0,d.jsx)(y.A,{}),(0,d.jsx)("h2",{children:"History & Logs"})]}),(0,d.jsxs)("div",{className:"history-grid-container",children:[(0,d.jsxs)("div",{className:"history-section",children:[(0,d.jsx)("h3",{children:"Workout History"}),(0,d.jsx)(u,{filterDate:n,setFilterDate:r,onEdit:e=>{N(e),p(!0)},showToast:c})]}),(0,d.jsxs)("div",{className:"history-section",children:[(0,d.jsx)("h3",{children:"Body Metric History"}),(0,d.jsx)(m,{metrics:w})]})]}),h&&(0,d.jsx)(x,{workout:v,onClose:()=>{N(null),p(!1)},showToast:c})]})}},6801:(e,s,t)=>{t.d(s,{A:()=>o});t(5043);var a=t(9981),i=t(6446),n=t(184),r=t(579);const o=e=>{let{label:s="Back",className:t=""}=e;const o=(0,a.Zp)();return(0,r.jsxs)(i.P.button,{className:"back-button-nav ".concat(t),onClick:()=>o(-1),whileHover:{x:-3},whileTap:{scale:.95},children:[(0,r.jsx)(n.QVr,{}),(0,r.jsx)("span",{children:s})]})}}}]);
//# sourceMappingURL=763.6f08764b.chunk.js.map