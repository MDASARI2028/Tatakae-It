"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[90],{3090:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var t=a(5043),n=a(9379),i=a(2524),l=a(8109),r=a(4448),c=a(6446),o=a(3546),d=a(184),m=a(579);const h=e=>{var s;let{template:a}=e;const{addWorkout:h}=(0,t.useContext)(i.Z),{templates:p,loading:u,error:x,refreshTemplates:j,deleteTemplate:g,updateTemplate:N,saveAsTemplate:v}=(0,t.useContext)(l.m),{calculateDailyXP:y}=(0,r.$)(),b=()=>{const e=new Date,s=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),t=String(e.getDate()).padStart(2,"0");return"".concat(s,"-").concat(a,"-").concat(t)},w={type:"Strength Training",duration:60,notes:"",date:b()},f=[{name:"",sets:1,reps:"",weight:"",setsData:[{reps:"",weight:""}]}],k=[{name:"",duration:"",caloriesBurned:""}],[C,T]=(0,t.useState)(w),[D,P]=(0,t.useState)(f),[S,A]=(0,t.useState)(k),[H,B]=(0,t.useState)(""),[W,q]=(0,t.useState)(""),[M,E]=(0,t.useState)(1),[F,_]=(0,t.useState)(!1),[L,R]=(0,t.useState)(null),[I,X]=(0,t.useState)(""),Z=async()=>{if(!I.trim())return;const e=await N(L,{templateName:I});e.success?(q("Template updated successfully"),R(null),X(""),setTimeout(()=>q(""),3e3)):(B(e.error||"Failed to update template"),setTimeout(()=>B(""),3e3))},O=e=>T((0,n.A)((0,n.A)({},C),{},{[e.target.name]:e.target.value})),Y=(e,s)=>{const{name:a,value:t}=s.target,i=[...D];if(i[e]=(0,n.A)((0,n.A)({},i[e]),{},{[a]:t}),"sets"===a){const s=parseInt(t)||0,a=i[e].setsData||[];if(s>a.length){const t=a.length>0?a[a.length-1]:{reps:"",weight:""},l=new Array(s-a.length).fill(null).map(()=>(0,n.A)({},t));i[e].setsData=[...a,...l]}else s<a.length&&(i[e].setsData=a.slice(0,s))}P(i)},Q=(e,s,a,t)=>{const i=[...D];i[e].setsData||(i[e].setsData=[]),i[e].setsData[s]=(0,n.A)((0,n.A)({},i[e].setsData[s]),{},{[a]:t}),P(i)},V=(e,s)=>{const a=S.map((a,t)=>t===e?(0,n.A)((0,n.A)({},a),{},{[s.target.name]:s.target.value}):a);A(a)};(0,t.useEffect)(()=>{if(a&&a.exercises){T({type:a.workoutType||"Strength Training",duration:60,notes:a.notes||"",date:b()});const e=a.exercises.map(e=>{const s=e.sets||3,a=e.setsData||new Array(s).fill({reps:e.reps||10,weight:e.weight||10});return{name:e.name||"",sets:s,reps:e.reps||10,weight:e.weight||10,setsData:a}});P(e.length>0?e:f)}},[a]);const K={hidden:{opacity:0,x:20},visible:{opacity:1,x:0,transition:{duration:.4}},exit:{opacity:0,x:-20,transition:{duration:.2}}};return(0,m.jsxs)(c.P.div,{className:"workout-logger-enhanced",variants:{hidden:{opacity:0},visible:{opacity:1,transition:{duration:.5}}},initial:"hidden",animate:"visible",children:[H&&(0,m.jsx)(c.P.div,{className:"alert alert-error",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},children:H}),W&&(0,m.jsxs)(c.P.div,{className:"alert alert-success",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0},children:[(0,m.jsx)(d.CMH,{})," ",W]}),(0,m.jsxs)("div",{className:"step-indicator",children:[[1,2,3].map(e=>(0,m.jsx)(c.P.div,{className:"step ".concat(M>=e?"active":""),onClick:()=>E(e),whileHover:{scale:1.1},children:e},e)),(0,m.jsx)("div",{className:"step-line",style:{width:"".concat((M-1)/2*100,"%")}})]}),(0,m.jsx)("form",{onSubmit:async e=>{e.preventDefault(),B(""),q("");let s=[];"Strength Training"===C.type?s=D.filter(e=>""!==e.name.trim()).map(e=>{let s=e.reps,a=e.weight;if(e.setsData&&e.setsData.length>0){const t=e.setsData.reduce((e,s)=>e+(Number(s.reps)||0),0),n=e.setsData.reduce((e,s)=>Math.max(e,Number(s.weight)||0),0);s=Math.round(t/e.setsData.length),a=n}return(0,n.A)((0,n.A)({},e),{},{reps:s,weight:a})}):"Cardio"===C.type&&(s=S.filter(e=>""!==e.name.trim()).map(e=>({name:e.name,duration:Number(e.duration)||0,caloriesBurned:Number(e.caloriesBurned)||0})));const a=(0,n.A)((0,n.A)({},C),{},{exercises:s}),t=await h(a);t.success?(q("Workout logged successfully!"),T(w),P(f),A(k),E(1),y&&(console.log("Triggering XP calculation after workout..."),y(!0).catch(e=>console.error("XP Trigger Error:",e))),setTimeout(()=>q(""),3e3)):B(t.error||"Failed to log workout.")},className:"workout-logger-form-enhanced",children:(0,m.jsxs)(o.N,{mode:"wait",children:[1===M&&(0,m.jsxs)(c.P.div,{variants:K,initial:"hidden",animate:"visible",exit:"exit",className:"form-step",children:[(0,m.jsxs)("div",{className:"step-header",children:[(0,m.jsx)(d.bB,{className:"step-icon"}),(0,m.jsx)("h3",{children:"Workout Basics"})]}),(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsx)("label",{children:"Date"}),(0,m.jsx)("input",{type:"date",name:"date",className:"form-input-enhanced",value:C.date,onChange:O,required:!0})]}),(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsx)("label",{children:"Workout Type"}),(0,m.jsx)("div",{className:"type-selector",children:["Strength Training","Cardio","Steps","Other"].map(e=>(0,m.jsxs)(c.P.label,{className:"type-option ".concat(C.type===e?"selected":""),whileHover:{scale:1.05},children:[(0,m.jsx)("input",{type:"radio",name:"type",value:e,checked:C.type===e,onChange:O}),(0,m.jsx)("span",{children:e})]},e))})]}),(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsxs)("label",{children:[(0,m.jsx)(d.w_X,{})," Duration (minutes)"]}),(0,m.jsx)("input",{type:"number",name:"duration",className:"form-input-enhanced",value:C.duration,onChange:O,min:"1",required:!0})]}),(0,m.jsx)(c.P.button,{type:"button",className:"btn-next",onClick:()=>E(2),whileHover:{scale:1.05},whileTap:{scale:.95},children:"Next \u2192"})]},"step1"),2===M&&(0,m.jsxs)(c.P.div,{variants:K,initial:"hidden",animate:"visible",exit:"exit",className:"form-step",children:[(0,m.jsxs)("div",{className:"step-header",children:["Cardio"===C.type?(0,m.jsx)(d.hTt,{className:"step-icon"}):(0,m.jsx)(d.bB,{className:"step-icon"}),(0,m.jsx)("h3",{children:"Cardio"===C.type?"Cardio Details":"Add Exercises"})]}),"Strength Training"===C.type&&a&&(0,m.jsxs)(c.P.div,{className:"template-quick-load",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},children:[(0,m.jsxs)("div",{className:"quick-load-header",children:[(0,m.jsx)(d.WCW,{className:"quick-load-icon"}),(0,m.jsxs)("span",{children:["Template Loaded: ",a.templateName]})]}),(0,m.jsxs)("p",{className:"quick-load-info",children:[(null===(s=a.exercises)||void 0===s?void 0:s.length)||0," exercises loaded from template"]})]}),"Strength Training"===C.type&&!a&&(0,m.jsxs)("div",{className:"template-selector-section",children:[(0,m.jsxs)("div",{className:"template-label-row",children:[(0,m.jsxs)("div",{className:"template-label-group",children:[(0,m.jsx)(d.WCW,{className:"template-label-icon"}),(0,m.jsx)("label",{className:"template-selector-label",children:"Load from Template"})]}),(0,m.jsxs)("div",{className:"template-actions",children:[(0,m.jsxs)("button",{type:"button",className:"manage-templates-btn ".concat(F?"active":""),onClick:()=>_(!F),title:"Manage Templates",children:[(0,m.jsx)(d.uO9,{})," Manage"]}),(0,m.jsx)("button",{type:"button",className:"refresh-templates-btn",onClick:j,title:"Refresh Templates",children:"\u21bb"})]})]}),(0,m.jsx)(o.N,{children:F&&(0,m.jsxs)(c.P.div,{className:"template-manager-panel",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:[(0,m.jsx)("h4",{className:"manager-title",children:"Manage Templates"}),0===p.length?(0,m.jsx)("p",{className:"no-templates-manager",children:"No templates found."}):(0,m.jsx)("ul",{className:"template-manage-list",children:p.map(e=>(0,m.jsx)("li",{className:"template-manage-item",children:L===e._id?(0,m.jsxs)("div",{className:"template-edit-row",children:[(0,m.jsx)("input",{type:"text",value:I,onChange:e=>X(e.target.value),className:"template-edit-input",autoFocus:!0}),(0,m.jsxs)("div",{className:"edit-actions",children:[(0,m.jsx)("button",{onClick:Z,className:"btn-icon-save",title:"Save",children:(0,m.jsx)(d.dIn,{})}),(0,m.jsx)("button",{onClick:()=>R(null),className:"btn-icon-cancel",title:"Cancel",children:(0,m.jsx)(d.QCr,{})})]})]}):(0,m.jsxs)("div",{className:"template-view-row",children:[(0,m.jsx)("span",{className:"template-name-display",children:e.templateName}),(0,m.jsxs)("div",{className:"template-item-actions",children:[(0,m.jsx)("button",{onClick:()=>(e=>{R(e._id),X(e.templateName)})(e),className:"btn-icon-edit",title:"Rename",children:(0,m.jsx)(d.uO9,{})}),(0,m.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this template?")){const s=await g(e);s.success?(q("Template deleted"),setTimeout(()=>q(""),3e3)):(B(s.error||"Failed to delete template"),setTimeout(()=>B(""),3e3))}})(e._id),className:"btn-icon-delete",title:"Delete",children:(0,m.jsx)(d.qbC,{})})]})]})},e._id))})]})}),u?(0,m.jsxs)("div",{className:"template-loading",children:[(0,m.jsx)("span",{className:"api-loader-spinner"})," Loading templates..."]}):x?(0,m.jsxs)("div",{className:"template-error",children:[(0,m.jsx)("p",{children:x}),(0,m.jsx)("button",{type:"button",onClick:j,className:"btn-retry",children:"Retry"})]}):p&&p.length>0&&(0,m.jsxs)("select",{className:"template-selector-dropdown",onChange:e=>{const s=p.find(s=>s._id===e.target.value);if(s){const e=s.exercises.map(e=>{const s=e.sets||3,a=new Array(s).fill({reps:e.reps||10,weight:e.weight||10});return{name:e.name||"",sets:s,reps:e.reps||10,weight:e.weight||10,setsData:a}});P(e.length>0?e:f),T((0,n.A)((0,n.A)({},C),{},{type:s.workoutType||"Strength Training",notes:s.notes||""}))}},defaultValue:"",children:[(0,m.jsx)("option",{value:"",disabled:!0,children:"Choose a template..."}),p.map(e=>(0,m.jsx)("option",{value:e._id,children:e.templateName},e._id))]})]}),"Cardio"===C.type&&(0,m.jsxs)("div",{className:"exercise-section-enhanced",children:[(0,m.jsx)(o.N,{children:S.map((e,s)=>(0,m.jsxs)(c.P.div,{layout:!0,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"exercise-card",children:[(0,m.jsxs)("div",{className:"exercise-header",children:[(0,m.jsxs)("div",{className:"exercise-name-row",children:[(0,m.jsxs)("span",{className:"exercise-number",children:["#",s+1]}),(0,m.jsx)("input",{type:"text",name:"name",className:"form-input-enhanced exercise-name-input",placeholder:"Exercise Name (e.g., Running)",value:e.name,onChange:e=>V(s,e),required:!0})]}),(0,m.jsx)(c.P.button,{type:"button",className:"remove-exercise-btn-enhanced",onClick:()=>(e=>{S.length>1&&A(S.filter((s,a)=>a!==e))})(s),whileHover:{scale:1.1,rotate:90},children:"\u2715"})]}),(0,m.jsxs)("div",{className:"exercise-stats",children:[(0,m.jsx)("input",{type:"number",name:"duration",className:"form-input-enhanced stat-input",placeholder:"Duration (min)",value:e.duration,onChange:e=>V(s,e),required:!0}),(0,m.jsx)("input",{type:"number",name:"caloriesBurned",className:"form-input-enhanced stat-input",placeholder:"Calories",value:e.caloriesBurned,onChange:e=>V(s,e),required:!0})]})]},s))}),(0,m.jsx)(c.P.button,{type:"button",className:"add-exercise-btn-enhanced",onClick:()=>A([...S,{name:"",duration:"",caloriesBurned:""}]),whileHover:{scale:1.05},whileTap:{scale:.95},children:"+ Add Cardio Exercise"})]}),"Steps"===C.type&&(0,m.jsxs)("div",{className:"cardio-grid",children:[(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsx)("label",{children:"Steps Walked"}),(0,m.jsx)("input",{type:"number",name:"steps",className:"form-input-enhanced",placeholder:"Number of steps",onChange:O})]}),(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsx)("label",{children:"Distance (km)"}),(0,m.jsx)("input",{type:"number",name:"distance",className:"form-input-enhanced",placeholder:"Distance",onChange:O})]})]}),"Strength Training"===C.type&&(0,m.jsxs)("div",{className:"exercise-section-enhanced",children:[(0,m.jsx)(o.N,{children:D.map((e,s)=>(0,m.jsxs)(c.P.div,{layout:!0,initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},className:"exercise-card",children:[(0,m.jsxs)("div",{className:"exercise-header",children:[(0,m.jsxs)("div",{className:"exercise-name-row",children:[(0,m.jsxs)("span",{className:"exercise-number",children:["#",s+1]}),(0,m.jsx)("input",{type:"text",name:"name",className:"form-input-enhanced exercise-name-input",placeholder:"Exercise Name (e.g., Bench Press)",value:e.name,onChange:e=>Y(s,e),required:!0})]}),(0,m.jsx)(c.P.button,{type:"button",className:"remove-exercise-btn-enhanced",onClick:()=>(e=>{D.length>1&&P(D.filter((s,a)=>a!==e))})(s),whileHover:{scale:1.1,rotate:90},children:"\u2715"})]}),(0,m.jsx)("div",{className:"exercise-sets-config",children:(0,m.jsxs)("div",{className:"form-group-enhanced compact",children:[(0,m.jsx)("label",{children:"Number of Sets:"}),(0,m.jsx)("input",{type:"number",name:"sets",className:"form-input-enhanced sets-count-input",value:e.sets,onChange:e=>Y(s,e),min:"1"})]})}),(0,m.jsxs)("div",{className:"sets-list",children:[(0,m.jsxs)("div",{className:"sets-header-row",children:[(0,m.jsx)("span",{className:"set-label",children:"Set"}),(0,m.jsx)("span",{className:"set-label",children:"Reps"}),(0,m.jsx)("span",{className:"set-label",children:"Weight (kg)"})]}),e.setsData&&e.setsData.map((e,a)=>(0,m.jsxs)(c.P.div,{className:"set-row",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},children:[(0,m.jsx)("div",{className:"set-number-badge",children:a+1}),(0,m.jsx)("input",{type:"number",className:"form-input-enhanced set-input",placeholder:"Reps",value:e.reps,onChange:e=>Q(s,a,"reps",e.target.value)}),(0,m.jsx)("input",{type:"number",className:"form-input-enhanced set-input",placeholder:"Kg",value:e.weight,onChange:e=>Q(s,a,"weight",e.target.value)})]},a))]})]},s))}),(0,m.jsx)(c.P.button,{type:"button",className:"btn-add-exercise",onClick:()=>P([...D,{name:"",sets:1,reps:"",weight:"",setsData:[{reps:"",weight:""}]}]),whileHover:{scale:1.05},children:"+ Add Exercise"})]}),(0,m.jsxs)("div",{className:"step-navigation",children:[(0,m.jsx)(c.P.button,{type:"button",className:"btn-prev",onClick:()=>E(1),whileHover:{scale:1.05},children:"\u2190 Back"}),(0,m.jsx)(c.P.button,{type:"button",className:"btn-next",onClick:()=>E(3),whileHover:{scale:1.05},children:"Next \u2192"})]})]},"step2"),3===M&&(0,m.jsxs)(c.P.div,{variants:K,initial:"hidden",animate:"visible",exit:"exit",className:"form-step",children:[(0,m.jsxs)("div",{className:"step-header",children:[(0,m.jsx)(d.EmU,{className:"step-icon"}),(0,m.jsx)("h3",{children:"Final Notes"})]}),(0,m.jsxs)("div",{className:"form-group-enhanced",children:[(0,m.jsx)("label",{children:"Workout Notes"}),(0,m.jsx)("textarea",{name:"notes",className:"form-textarea-enhanced",placeholder:"How did the workout go? Any notes...",value:C.notes,onChange:O,rows:"5"})]}),(0,m.jsxs)("div",{className:"review-summary",children:[(0,m.jsx)("h4",{children:"Summary"}),(0,m.jsxs)("div",{className:"summary-item",children:[(0,m.jsx)("span",{children:"Date:"})," ",(0,m.jsx)("strong",{children:C.date})]}),(0,m.jsxs)("div",{className:"summary-item",children:[(0,m.jsx)("span",{children:"Type:"})," ",(0,m.jsx)("strong",{children:C.type})]}),(0,m.jsxs)("div",{className:"summary-item",children:[(0,m.jsx)("span",{children:"Duration:"})," ",(0,m.jsxs)("strong",{children:[C.duration," min"]})]}),"Strength Training"===C.type&&(0,m.jsxs)("div",{className:"summary-item",children:[(0,m.jsx)("span",{children:"Exercises:"})," ",(0,m.jsx)("strong",{children:D.filter(e=>e.name).length})]})]}),(0,m.jsxs)("div",{className:"step-navigation",children:[(0,m.jsx)(c.P.button,{type:"button",className:"btn-prev",onClick:()=>E(2),whileHover:{scale:1.05},children:"\u2190 Back"}),(0,m.jsxs)(c.P.button,{type:"button",className:"btn-save-template-step",onClick:async()=>{const e={type:C.type,notes:C.notes,exercises:"Cardio"===C.type?S:D.filter(e=>""!==e.name.trim())},s=await v(e);s.success?(q("Saved as template!"),setTimeout(()=>q(""),3e3)):(B(s.error||"Failed to save template"),setTimeout(()=>B(""),3e3))},whileHover:{scale:1.05},title:"Save current setup as a new template",children:[(0,m.jsx)(d.dIn,{})," Save Template"]}),(0,m.jsx)(c.P.button,{type:"submit",className:"btn-submit",whileHover:{scale:1.05},whileTap:{scale:.95},children:"\u2713 Log Workout"})]})]},"step3")]})})]})};var p=a(6801);const u=()=>{const{workouts:e}=(0,t.useContext)(i.Z),s=e.filter(e=>{const s=new Date(e.date),a=new Date;return s>=new Date(a.getTime()-6048e5)&&s<=a}).length,a=e.filter(e=>{const s=new Date(e.date),a=new Date;return s.getMonth()===a.getMonth()&&s.getFullYear()===a.getFullYear()}).length,n=e.length;return(0,m.jsxs)("div",{className:"workout-logger-page-wrapper",children:[(0,m.jsx)("div",{className:"gradient-mesh-background"}),(0,m.jsx)("div",{className:"workout-logger-page",children:(0,m.jsxs)("div",{className:"logger-split-layout",children:[(0,m.jsxs)("div",{className:"logger-left-panel",children:[(0,m.jsx)("div",{style:{marginBottom:"1rem"},children:(0,m.jsx)(p.A,{})}),(0,m.jsxs)(c.P.div,{className:"logger-hero-header",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{duration:.6},children:[(0,m.jsxs)("div",{className:"hero-title-section",children:[(0,m.jsx)(d.bB,{className:"hero-icon"}),(0,m.jsx)("h1",{className:"hero-title",children:"Log Workouts"})]}),(0,m.jsx)("p",{className:"hero-subtitle",children:"Track your progress, build your strength"})]}),(0,m.jsxs)(c.P.div,{className:"quick-stats-stack",initial:{opacity:0,x:-30},animate:{opacity:1,x:0},transition:{delay:.2,duration:.5},children:[(0,m.jsxs)(c.P.div,{className:"stat-card",whileHover:{scale:1.05,x:10},transition:{type:"spring",stiffness:300},children:[(0,m.jsx)(d.Itl,{className:"stat-icon fire"}),(0,m.jsxs)("div",{className:"stat-content",children:[(0,m.jsx)("span",{className:"stat-value",children:s}),(0,m.jsx)("span",{className:"stat-label",children:"This Week"})]})]}),(0,m.jsxs)(c.P.div,{className:"stat-card",whileHover:{scale:1.05,x:10},transition:{type:"spring",stiffness:300},children:[(0,m.jsx)(d.bfZ,{className:"stat-icon calendar"}),(0,m.jsxs)("div",{className:"stat-content",children:[(0,m.jsx)("span",{className:"stat-value",children:a}),(0,m.jsx)("span",{className:"stat-label",children:"This Month"})]})]}),(0,m.jsxs)(c.P.div,{className:"stat-card",whileHover:{scale:1.05,x:10},transition:{type:"spring",stiffness:300},children:[(0,m.jsx)(d.SBv,{className:"stat-icon trophy"}),(0,m.jsxs)("div",{className:"stat-content",children:[(0,m.jsx)("span",{className:"stat-value",children:n}),(0,m.jsx)("span",{className:"stat-label",children:"Total Logged"})]})]})]})]}),(0,m.jsx)(c.P.div,{className:"logger-right-panel",initial:{opacity:0,x:30},animate:{opacity:1,x:0},transition:{delay:.3,duration:.5},children:(0,m.jsx)(h,{})})]})})]})}},6801:(e,s,a)=>{a.d(s,{A:()=>r});a(5043);var t=a(9981),n=a(6446),i=a(184),l=a(579);const r=e=>{let{label:s="Back",className:a=""}=e;const r=(0,t.Zp)();return(0,l.jsxs)(n.P.button,{className:"back-button-nav ".concat(a),onClick:()=>r(-1),whileHover:{x:-3},whileTap:{scale:.95},children:[(0,l.jsx)(i.QVr,{}),(0,l.jsx)("span",{children:s})]})}}}]);
//# sourceMappingURL=90.57300c9a.chunk.js.map